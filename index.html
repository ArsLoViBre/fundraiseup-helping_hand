<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fundraise Up Demo</title>
    
    <!-- Подключение Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B48YE1WDMM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-B48YE1WDMM');
    </script>

    <!-- Подключение Fundraise Up -->
    <script>(function(w,d,s,n,a){if(!w[n]){var l='call,catch,on,once,set,then,track'
    .split(','),i,o=function(n){return'function'==typeof n?o.l.push([arguments])&&o
    :function(){return o.l.push([n,arguments])&&o}},t=d.getElementsByTagName(s)[0],
    j=d.createElement(s);j.async=!0;j.src='https://cdn.fundraiseup.com/widget/'+a;
    t.parentNode.insertBefore(j,t);o.s=Date.now();o.v=4;o.h=w.location.href;o.l=[];
    for(i=0;i<7;i++)o[l[i]]=o(l[i]);w[n]=o}
    })(window,document,'script','FundraiseUp','AEMZUDUM');</script>
</head>
<body>

    <h1>Демо интеграции Fundraise Up с Google Analytics</h1>

    <!-- Кнопка для тестового пожертвования -->
    <button id="donateButton" style="padding: 10px 20px; background-color: green; color: white; text-decoration: none; border-radius: 5px; border: none; cursor: pointer;">
        Пожертвовать (тест)
    </button>

    <script>
        document.getElementById('donateButton').addEventListener('click', function() {
            console.log("Кнопка нажата, открываем чекаут в тестовом режиме...");
            
            // Отправляем событие в GA4
            gtag('event', 'checkout_open', {
                'event_category': 'donation',
                'event_label': 'FundraiseUp'
            });

            // Открываем чекаут с включенным тестовым режимом
            FundraiseUp.checkout({ test: true }).catch(error => {
                console.error("Ошибка открытия чекаута:", error);
            });
        });

        // Фиксируем успешное завершение пожертвования в GA4
        FundraiseUp.on('checkout', function(checkout) {
            checkout.on('complete', function(donation) {
                console.log("Пожертвование завершено, отправляем данные в GA4:", donation);

                gtag('event', 'purchase', {
                    'event_category': 'donation',
                    'event_label': 'FundraiseUp',
                    'value': donation.amount,
                    'currency': donation.currency
                });
            });
        });
    </script>

</body>
</html>
